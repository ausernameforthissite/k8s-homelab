---
kind: Deployment
apiVersion: apps/v1
metadata:
  name: snapshot-controller
  namespace: pv-snapshots
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: snapshot-controller
  template:
    spec:
      containers:
      - name: snapshot-controller
        image: registry.k8s.io/sig-storage/snapshot-controller:v8.3.0
        args:
        - --v=5
        - --leader-election=true
        - --feature-gates=CSIVolumeGroupSnapshot=true
        - --retry-crd-interval-max=0
        - --enable-distributed-snapshotting=true
        - --automaxprocs
        resources:
          requests:
            cpu: 1m
            memory: 15Mi
          limits:
            memory: 30Mi
