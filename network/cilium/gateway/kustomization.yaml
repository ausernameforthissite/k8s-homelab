---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: gateways

resources:
- ./private-gateway.yaml
- ./private-redirect.yaml
- ./public-gateway.yaml
- ./public-redirect.yaml
- ../../../ingress/manual-wildcard/domain-info

replacements:
- source:
    kind: ConfigMap
    name: main-domain-info
    fieldPath: data.secret_name
  targets:
  - select:
      kind: Gateway
      name: main-public
    fieldPaths:
    - spec.listeners.1.tls.certificateRefs.0.name
- source:
    kind: ConfigMap
    name: main-domain-info
    fieldPath: data.secret_name
  targets:
  - select:
      kind: Gateway
      name: main-public
    fieldPaths:
    - spec.listeners.2.tls.certificateRefs.0.name
- source:
    kind: ConfigMap
    name: main-domain-info
    fieldPath: data.secret_name
  targets:
  - select:
      kind: Gateway
      name: main-private
    fieldPaths:
    - spec.listeners.1.tls.certificateRefs.0.name
- source:
    kind: ConfigMap
    name: main-domain-info
    fieldPath: data.secret_name
  targets:
  - select:
      kind: Gateway
      name: main-private
    fieldPaths:
    - spec.listeners.2.tls.certificateRefs.0.name
