---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-viewer-edge
  namespace: ome
spec:
  podSelector:
    matchLabels:
      app: ovenmediaengine
      ome-type: edge
  ingress:
  - ports:
    - port: publish
    - port: webrtc-10000
      protocol: UDP
    - port: turn
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-ovt
  namespace: ome
spec:
  podSelector:
    matchLabels:
      app: ovenmediaengine
      ome-type: origin
  ingress:
  - ports:
    - port: origin-ovt
    # cilium can't work with selectors in native routing mode
    # from:
    # - podSelector: {}
        # matchLabels:
        #   app: ovenmediaengine
        #   ome-type: edge
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-redis
  namespace: ome
spec:
  podSelector:
    matchLabels:
      app: redis
  ingress:
  - ports:
    - port: redis
    # from:
    # - namespaceSelector: {}
    #   podSelector: {}
